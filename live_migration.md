
# ライブマイグレーション

ライブマイグレーションを事項する物理サーバ間でディスクを共有し、仮想マシンのイメージを格納しておく

1. 物理サーバ1で稼働する仮想マシンAと同じイメージの仮想マシンBを物理サーバ2で立ち上げておく
2. 仮想マシンAのメモリ内容のスナップショットをライブマイグレーション専用のネットワークで仮想マシンBに転送する
3. 引き継ぎの準備の完了時点で仮想マシンA上で稼働しているアプリケーションを停止させる
4. 2の時点からの差分を仮想マシンBに転送する
5. 仮想マシンAを停止する
6. 仮想マシンBが共有ストレージ上の仮想マシンAの領域を引き継ぎ、仮想マシンAとしての動作を開始する
7. 仮想マシンBがRARPフレームを送信する

## 仮想マシンの移動

- 仮想マシンが別の物理サーバに移動して稼働する時、仮想マシンはRARPフレームを送信して同一サブネットワークに存在するL2スイッチのMACアドレステーブルを更新する
- RARPフレームを送信する理由は、RARPサーバ以外に副作用がないため（最近だとRARPサーバを設置しない）

